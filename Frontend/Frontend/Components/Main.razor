@page "/"
@using System.Diagnostics.CodeAnalysis
@using Audio
@using Images
@implements IDisposable

<PageTitle>Post radio</PageTitle>

<ImagesView State="@State"></ImagesView>
<AudioPlayer State="@State"></AudioPlayer>
<SongDataView State="@State"></SongDataView>
<ControlsView State="@State"></ControlsView>
<StartWait State="@State"></StartWait>

@code {
    [Inject] private ISongsCollection SongsCollection { get; set; }
    [Inject] private IImagesCollection ImagesCollection { get; set; }
    [Inject] private IOnlineTracker Tracker { get; set; }

    [field: AllowNull, MaybeNull]
    private SessionState State
    {
        get
        {
            if (field == null)
            {
                field = new SessionState(SongsCollection, ImagesCollection);
                Tracker.Track(field.Lifetime);
            }

            return field;
        }
    }

    public void Dispose()
    {
        State.Dispose();
    }

}